<!DOCTYPE html><html lang="ru"><head><meta charSet="utf-8"/><link rel="preload" as="font" href="/_next/static/media/c9a5bc6a7c948fb0-s.p.woff2" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/19fb18cc819f362f.css" data-precedence="next"/><link rel="preload" href="/_next/static/chunks/webpack-ba12b6bfadc156e2.js" as="script"/><link rel="preload" href="/_next/static/chunks/fd9d1056-c9eb6f688b3961a6.js" as="script"/><link rel="preload" href="/_next/static/chunks/596-547d92dce03e0a0e.js" as="script"/><link rel="preload" href="/_next/static/chunks/main-app-624e2ce57dae3e7f.js" as="script"/><link rel="preload" as="image" href="/img/SystemDb.jpg" fetchPriority="high"/><title>Решение проблемы роста базы данных Frontol</title><meta name="description" content="Утилита для обслуживания баз данных Frontol, решает проблему роста базы данных"/><meta name="keywords" content="Frontol cветка, Фронтол тормозит поиск, Frontol рост базы данных, Frontol remaind"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="any"/><meta name="next-size-adjust"/><script src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js" noModule=""></script></head><body class="__className_e66fe9"><div class="wrapper"><nav class="navbar navbar-expand-md navbar-dark bg-dark"><div class="container-fluid"><a class="navbar-brand" href="/">Frontol Service Addon</a><button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><header class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav me-auto"><li class="nav-item"><a class="active nav-link" href="/">О программе</a></li><li class="nav-item"><a class=" nav-link" href="/download">Скачать</a></li><li class="nav-item"><a class=" nav-link" href="/overview">Описание</a></li><li class="nav-item"><a class=" nav-link" href="/contact">Контакты</a></li></ul></header></div></nav><div class="content container-xxl my-md-4 bd-layout"><main><div class="container"><h1>Причины роста базы данных Frontol</h1><p>Если у вас большой справочник товаров, вы можете столкнуться с ростом базы данных Frontol. Проблема возникает из за роста таблицы <strong>Remaind</strong>. При каждой новой загрузке остатков из товароучетной системы возникают новые записи в таблице, к сожалению старые записи удаляются не всегда.</p><h2>Используйте стандартные настроки Frontol</h2><img alt="Настроки свертки остатков" fetchPriority="high" width="946" height="501" decoding="async" data-nimg="1" class="img-fluid rounded mx-auto d-block mb-3" style="color:transparent" src="/img/SystemDb.jpg"/><p>Возможно вам следует воспользоваться стандартными настройками фронтол. Установите галочки свертка <strong>счетчиков</strong> и свертка <strong>остатков</strong>Если ваш справочник товара не большой вам должно помочь.</p><h2>Не помогает?</h2><p>Попробуем понять почему это происходит. За свертку остатков во frontol отвечает stored procedure <strong>Remaind_collapse</strong>. В этой процедуре происходит чтение остатков из таблицы <strong>Remaind</strong>. Добавление новых записей с остатками и удаление всех старых записей. Если у вас число записей достаточно большое мы получаем<a href="https://www.ibase.ru/45-ways-to-improve-firebird-performance-russian/"> длинную пишущую транзакцию</a>. Для слабых кассовых компьютеров это не сработает и данных их таблицы не удалятся. В дальнейшем это вызовет рост размера базы данных, медленное открывание окна поиска товара ну и самой главное увеличение частоты <strong>повреждений</strong> базы данных.</p><h2>Решение</h2><p>Очевидно необходимо сократить количество изменяемых элементов за одну транзакцию. Разделить свертку на пакеты например по 10 элементов. Таким образом мы избавимся от длинной транзации. Читаем например первые 10 записей, более 4 копий. Удаляем и записываем повторно</p><p><code>SELECT FIRST 10 REMAINID, SUM(IIF(DTYPE = 0, DELTA, 0))AS SUMMA0, SUM(IIF(DTYPE = 1, DELTA, 0)) AS SUMMA1 <br/>FROM REMAIND RD <br/>GROUP BY REMAINID <br/>HAVING COUNT(ID) &gt; 4</code></p><p><code>DELETE FROM REMAIND <br/> WHERE REMAINID=:RemainId</code></p><p><code>INSERT INTO REMAIND(ID, REMAINID, DELTA, CHNG, DTYPE) <br/>VALUES (GEN_ID(GREMAIND, 1), :RemainId, :Summa0, -1, 0)</code></p><p><code>INSERT INTO REMAIND(ID, REMAINID, DELTA, CHNG, DTYPE) <br/>VALUES (GEN_ID(GREMAIND, 1), :RemainId, :Summa1, -1, 1)</code></p><h2>Реализация</h2><p>Написана утилита которая запускается при открытии Frontol. Утилита сворачивается в Trey так чтобы кассир не смог закрыть ее случайно. Она запускает процедуру свертки остатков в течении рабочего дня, не мешая при этом кассиру. Также утилита позволяет выгружать справочник товаров, продажные цены, минимально допустимые цены, остатки. Эту информацию мы используем как обратную связь в товароучетной системе. То есть мы знаем какая информация содержится в базе данных каждой кассы и выгружаем только измененные данные. Это сокращает разрастание таблицы <strong>Remaind</strong>.</p><div class="btn-download"><a href="download" class="btn btn-primary btn-lg" role="button">Скачать</a></div><h2>Вывод.</h2><p>На форуме frontol существую темы с этой проблемой но к сожалению решения от разработчиков пока нет. Видимо проблема не совсем актуальна.</p></div></main></div><footer class="Footer_pageFooter__1f4SB font-small" style="color:#f7f7f7"><div class="footer-copyright text-dark text-center pt-2">© 2023 Copyright:</div></footer></div><script src="/_next/static/chunks/webpack-ba12b6bfadc156e2.js" async=""></script><script src="/_next/static/chunks/fd9d1056-c9eb6f688b3961a6.js" async=""></script><script src="/_next/static/chunks/596-547d92dce03e0a0e.js" async=""></script><script src="/_next/static/chunks/main-app-624e2ce57dae3e7f.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/media/c9a5bc6a7c948fb0-s.p.woff2\",{\"as\":\"font\",\"type\":\"font/woff2\"}]\n2:HL[\"/_next/static/css/19fb18cc819f362f.css\",{\"as\":\"style\"}]\n0:\"$L3\"\n"])</script><script>self.__next_f.push([1,"4:I{\"id\":7948,\"chunks\":[\"272:static/chunks/webpack-ba12b6bfadc156e2.js\",\"971:static/chunks/fd9d1056-c9eb6f688b3961a6.js\",\"596:static/chunks/596-547d92dce03e0a0e.js\"],\"name\":\"default\",\"async\":false}\n6:I{\"id\":6628,\"chunks\":[\"272:static/chunks/webpack-ba12b6bfadc156e2.js\",\"971:static/chunks/fd9d1056-c9eb6f688b3961a6.js\",\"596:static/chunks/596-547d92dce03e0a0e.js\"],\"name\":\"GlobalError\",\"async\":false}\n7:I{\"id\":3015,\"chunks\":[\"835:static/chunks/835-98d773ba05c6e15b.js\",\"185:static/chunks/app/layout-e738da3c66daee"])</script><script>self.__next_f.push([1,"7f.js\"],\"name\":\"\",\"async\":false}\n9:I{\"id\":6685,\"chunks\":[\"835:static/chunks/835-98d773ba05c6e15b.js\",\"185:static/chunks/app/layout-e738da3c66daee7f.js\"],\"name\":\"\",\"async\":false}\na:I{\"id\":464,\"chunks\":[\"835:static/chunks/835-98d773ba05c6e15b.js\",\"185:static/chunks/app/layout-e738da3c66daee7f.js\"],\"name\":\"Navlinks\",\"async\":false}\nb:I{\"id\":7767,\"chunks\":[\"272:static/chunks/webpack-ba12b6bfadc156e2.js\",\"971:static/chunks/fd9d1056-c9eb6f688b3961a6.js\",\"596:static/chunks/596-547d92dce03e0a0e.js\"],\"name\":\"default\""])</script><script>self.__next_f.push([1,",\"async\":false}\nc:I{\"id\":7920,\"chunks\":[\"272:static/chunks/webpack-ba12b6bfadc156e2.js\",\"971:static/chunks/fd9d1056-c9eb6f688b3961a6.js\",\"596:static/chunks/596-547d92dce03e0a0e.js\"],\"name\":\"default\",\"async\":false}\nd:I{\"id\":3222,\"chunks\":[\"222:static/chunks/222-6eee7aea458bad19.js\",\"931:static/chunks/app/page-027dd4d6a86af49c.js\"],\"name\":\"Image\",\"async\":false}\ne:I{\"id\":160,\"chunks\":[\"835:static/chunks/835-98d773ba05c6e15b.js\",\"185:static/chunks/app/layout-e738da3c66daee7f.js\"],\"name\":\"Footer\",\"async\":false}\n"])</script><script>self.__next_f.push([1,"f:I{\"id\":209,\"chunks\":[\"835:static/chunks/835-98d773ba05c6e15b.js\",\"185:static/chunks/app/layout-e738da3c66daee7f.js\"],\"name\":\"CookieConsent\",\"async\":false}\n8:T68e,"])</script><script>self.__next_f.push([1,"\n                window.dataLayer = window.dataLayer || [];\n                function gtag() {\n                    dataLayer.push(arguments);\n                }\n\n                (function initConsent() {\n                    const consentPropertyType = 'site_consent';\n                    const cookies = document.cookie\n                        .split(';')\n                        .map(cookie =\u003e cookie.split('='))\n                        .reduce((acc, [consentPropertyType, value]) =\u003e ({...acc, [consentPropertyType.trim()] : value}), {});\n                    \n                    const hasConsented = () =\u003e cookies[consentPropertyType] === \"true\" ? true : false;\n                    \n                    let consentPayload = {\n                        ad_storage: hasConsented() ? \"granted\" : \"denied\",\n                        analytics_storage: hasConsented() ? \"granted\" : \"denied\",\n                        facebook: hasConsented() ? \"granted\" : \"denied\"\n                    }\n                    \n                    if (!hasConsented()) {\n                        consentPayload.wait_for_update = 2000 // milliseconds\n                    }\n                    gtag(\"consent\", \"default\", consentPayload);\n                })();\n                \n                (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':\n                new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],\n                j=d.createElement(s),dl=l!='dataLayer'?'\u0026l='+l:'';j.async=true;j.src=\n                'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);\n                })(window,document,'script','dataLayer','GTM-KQ6C9F2');\n            "])</script><script>self.__next_f.push([1,"3:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/19fb18cc819f362f.css\",\"precedence\":\"next\"}]],[\"$\",\"$L4\",null,{\"buildId\":\"9NQyGVh2lsB2Tc7RcLNf_\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/\",\"initialTree\":[\"\",{\"children\":[\"__PAGE__\",{}]},\"$undefined\",\"$undefined\",true],\"initialHead\":\"$L5\",\"globalErrorComponent\":\"$6\",\"children\":[[\"$\",\"html\",null,{\"lang\":\"ru\",\"children\":[\"$\",\"body\",null,{\"className\":\"__className_e66fe9\",\"children\":[[\"$\",\"div\",null,{\"className\":\"wrapper\",\"children\":[[\"$\",\"$L7\",null,{\"id\":\"google-tag-manager\",\"strategy\":\"afterInteractive\",\"children\":\"$8\"}],[\"$\",\"nav\",null,{\"className\":\"navbar navbar-expand-md navbar-dark bg-dark\",\"children\":[\"$\",\"div\",null,{\"className\":\"container-fluid\",\"children\":[[\"$\",\"$L9\",null,{\"className\":\"navbar-brand\",\"href\":\"/\",\"children\":\"Frontol Service Addon\"}],[\"$\",\"button\",null,{\"className\":\"navbar-toggler\",\"type\":\"button\",\"data-bs-toggle\":\"collapse\",\"data-bs-target\":\"#navbarSupportedContent\",\"aria-controls\":\"navbarSupportedContent\",\"aria-expanded\":\"false\",\"aria-label\":\"Toggle navigation\",\"children\":[\"$\",\"span\",null,{\"className\":\"navbar-toggler-icon\"}]}],[\"$\",\"header\",null,{\"className\":\"collapse navbar-collapse\",\"id\":\"navbarSupportedContent\",\"children\":[\"$\",\"$La\",null,{}]}]]}]}],[\"$\",\"div\",null,{\"className\":\"content container-xxl my-md-4 bd-layout\",\"children\":[\"$\",\"main\",null,{\"children\":[\"$\",\"$Lb\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$Lc\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[[\"$\",\"div\",null,{\"className\":\"container\",\"children\":[[\"$\",\"h1\",null,{\"children\":\"Причины роста базы данных Frontol\"}],[\"$\",\"p\",null,{\"children\":[\"Если у вас большой справочник товаров, вы можете столкнуться с ростом базы данных Frontol. Проблема возникает из за роста таблицы \",[\"$\",\"strong\",null,{\"children\":\"Remaind\"}],\". При каждой новой загрузке остатков из товароучетной системы возникают новые записи в таблице, к сожалению старые записи удаляются не всегда.\"]}],[\"$\",\"h2\",null,{\"children\":\"Используйте стандартные настроки Frontol\"}],[\"$\",\"$Ld\",null,{\"className\":\"img-fluid rounded mx-auto d-block mb-3\",\"src\":\"/img/SystemDb.jpg\",\"width\":946,\"height\":501,\"priority\":true,\"alt\":\"Настроки свертки остатков\"}],[\"$\",\"p\",null,{\"children\":[\"Возможно вам следует воспользоваться стандартными настройками фронтол. Установите галочки свертка \",[\"$\",\"strong\",null,{\"children\":\"счетчиков\"}],\" и свертка \",[\"$\",\"strong\",null,{\"children\":\"остатков\"}],\"Если ваш справочник товара не большой вам должно помочь.\"]}],[\"$\",\"h2\",null,{\"children\":\"Не помогает?\"}],[\"$\",\"p\",null,{\"children\":[\"Попробуем понять почему это происходит. За свертку остатков во frontol отвечает stored procedure \",[\"$\",\"strong\",null,{\"children\":\"Remaind_collapse\"}],\". В этой процедуре происходит чтение остатков из таблицы \",[\"$\",\"strong\",null,{\"children\":\"Remaind\"}],\". Добавление новых записей с остатками и удаление всех старых записей. Если у вас число записей достаточно большое мы получаем\",[\"$\",\"a\",null,{\"href\":\"https://www.ibase.ru/45-ways-to-improve-firebird-performance-russian/\",\"children\":\" длинную пишущую транзакцию\"}],\". Для слабых кассовых компьютеров это не сработает и данных их таблицы не удалятся. В дальнейшем это вызовет рост размера базы данных, медленное открывание окна поиска товара ну и самой главное увеличение частоты \",[\"$\",\"strong\",null,{\"children\":\"повреждений\"}],\" базы данных.\"]}],[\"$\",\"h2\",null,{\"children\":\"Решение\"}],[\"$\",\"p\",null,{\"children\":\"Очевидно необходимо сократить количество изменяемых элементов за одну транзакцию. Разделить свертку на пакеты например по 10 элементов. Таким образом мы избавимся от длинной транзации. Читаем например первые 10 записей, более 4 копий. Удаляем и записываем повторно\"}],[\"$\",\"p\",null,{\"children\":[\"$\",\"code\",null,{\"children\":[\"SELECT FIRST 10 REMAINID, SUM(IIF(DTYPE = 0, DELTA, 0))AS SUMMA0, SUM(IIF(DTYPE = 1, DELTA, 0)) AS SUMMA1 \",[\"$\",\"br\",null,{}],\"FROM REMAIND RD \",[\"$\",\"br\",null,{}],\"GROUP BY REMAINID \",[\"$\",\"br\",null,{}],\"HAVING COUNT(ID) \u003e 4\"]}]}],[\"$\",\"p\",null,{\"children\":[\"$\",\"code\",null,{\"children\":[\"DELETE FROM REMAIND \",[\"$\",\"br\",null,{}],\" WHERE REMAINID=:RemainId\"]}]}],[\"$\",\"p\",null,{\"children\":[\"$\",\"code\",null,{\"children\":[\"INSERT INTO REMAIND(ID, REMAINID, DELTA, CHNG, DTYPE) \",[\"$\",\"br\",null,{}],\"VALUES (GEN_ID(GREMAIND, 1), :RemainId, :Summa0, -1, 0)\"]}]}],[\"$\",\"p\",null,{\"children\":[\"$\",\"code\",null,{\"children\":[\"INSERT INTO REMAIND(ID, REMAINID, DELTA, CHNG, DTYPE) \",[\"$\",\"br\",null,{}],\"VALUES (GEN_ID(GREMAIND, 1), :RemainId, :Summa1, -1, 1)\"]}]}],[\"$\",\"h2\",null,{\"children\":\"Реализация\"}],[\"$\",\"p\",null,{\"children\":[\"Написана утилита которая запускается при открытии Frontol. Утилита сворачивается в Trey так чтобы кассир не смог закрыть ее случайно. Она запускает процедуру свертки остатков в течении рабочего дня, не мешая при этом кассиру. Также утилита позволяет выгружать справочник товаров, продажные цены, минимально допустимые цены, остатки. Эту информацию мы используем как обратную связь в товароучетной системе. То есть мы знаем какая информация содержится в базе данных каждой кассы и выгружаем только измененные данные. Это сокращает разрастание таблицы \",[\"$\",\"strong\",null,{\"children\":\"Remaind\"}],\".\"]}],[\"$\",\"div\",null,{\"className\":\"btn-download\",\"children\":[\"$\",\"a\",null,{\"href\":\"download\",\"className\":\"btn btn-primary btn-lg\",\"role\":\"button\",\"children\":\"Скачать\"}]}],[\"$\",\"h2\",null,{\"children\":\"Вывод.\"}],[\"$\",\"p\",null,{\"children\":\"На форуме frontol существую темы с этой проблемой но к сожалению решения от разработчиков пока нет. Видимо проблема не совсем актуальна.\"}]]}],null],\"segment\":\"__PAGE__\"},\"styles\":[]}]}]}],[\"$\",\"$Le\",null,{}]]}],[\"$\",\"$Lf\",null,{}]]}]}],null]}]]\n"])</script><script>self.__next_f.push([1,"5:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"1\",{\"children\":\"Решение проблемы роста базы данных Frontol\"}],[\"$\",\"meta\",\"2\",{\"name\":\"description\",\"content\":\"Утилита для обслуживания баз данных Frontol, решает проблему роста базы данных\"}],[\"$\",\"meta\",\"3\",{\"name\":\"keywords\",\"content\":\"Frontol cветка, Фронтол тормозит поиск, Frontol рост базы данных, Frontol remaind\"}],[\"$\",\"meta\",\"4\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"link\",\"5\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"any\"}],[\"$\",\"meta\",\"6\",{\"name\":\"next-size-adjust\"}]]\n"])</script></body></html>